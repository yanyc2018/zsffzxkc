<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>åŸºç¡€è¡¨å•</title>
    <link rel="stylesheet" href="__LIBS__/layui/css/layui.css" />
    <link rel="stylesheet" href="__MODULE__/admin.css?v=317" />
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        #formBasForm {
           max-width: 800px;
            margin: 30px 200px 50px;
        }

        .layui-form-item {
            display: flex !important;
        }

        .layui-form-label {
            flex: 3;
        }

        .layui-input-block {
            flex: 14;
        }

        .layui-input-block {
            margin-left: 20px !important;
            min-height: 36px;
        }
        .layui-upload-img {
            width: 200px;
            min-height: 120px;
            height: auto;
            margin: 0 10px 10px 0;
        }
        #formBasForm .layui-form-item {
            margin-bottom: 25px;
        }
    </style>
</head>

<body>
    <!-- åŠ è½½åŠ¨ç”» -->
    <div class="page-loading">
        <div class="ball-loader">
            <span></span><span></span><span></span><span></span>
        </div>
    </div>
    <!-- æ­£æ–‡å¼€å§‹ -->
    <div class="layui-fluid">
        <div class="layui-card">
            <div class="layui-card-header">æ·»åŠ è®²å¸ˆ </div>
            <div class="layui-card-body">
                <!-- è¡¨å•å¼€å§‹ -->
                <form class="layui-form" id="formBasForm" lay-filter="formBasForm">
                    <input type="hidden" name="id" value="{$item['id']?$item['id']:''}">
                    <div class="layui-form-item">
                        <label class="layui-form-label layui-form-required">è€å¸ˆå§“å:</label>
                        <div class="layui-input-block">
                            <input name="imgname" class="layui-input" required lay-verify="required" value="{$item['imgname']?$item['imgname']:''}" />
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label layui-form-required">ç…§ç‰‡:</label>
                        <input type="hidden" name="img" lay-verify="required" required value="{$item['img']?$item['img']:''}">
                        <div class="layui-upload layui-input-block">
                            <button type="button" class="layui-btn" id="test1"><i class="layui-icon">&#xe67c;</i>ä¸Šä¼ ç…§ç‰‡</button>
                            <div class="layui-upload-list">
                                <img class="layui-upload-img" src="{$item['img']?$item['img']:''}" id="demo1">
                                <p id="demoText"></p>
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label layui-form-required">æ‰‹æœºå·(ç™»å½•è´¦å·):</label>
                        <div class="layui-input-block">
                            <input name="tphone" class="layui-input" required lay-verify="required" value="{$item['tphone']?$item['tphone']:''}" />
                        </div>
                    </div>
<!--                    <div class="layui-form-item">-->
<!--                        <label class="layui-form-label layui-form-required">å¯†ç (é»˜è®¤æ‰‹æœºå·åå…­ä½):</label>-->
<!--                        <div class="layui-input-block">-->
<!--                            <input name="tpassword" type="password" class="layui-input" required lay-verify="required" />-->
<!--                        </div>-->
<!--                    </div>-->
                    <div class="layui-form-item">
                        <label class="layui-form-label layui-form-required">ç®€ä»‹:</label>
                        <div class="layui-input-block">
                            <textarea name="introduce" id="LAY_editor2" >{$item['introduce']?$item['introduce']:''}</textarea>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-input-block" style="display: flex;justify-content: space-around;">
                            <button class="layui-btn" lay-filter="formBasSubmit" lay-submit>&emsp;æäº¤&emsp;</button>
                            <button type="reset" class="layui-btn layui-btn-primary">&emsp;é‡ç½®&emsp;</button>
                        </div>
                    </div>
                </form>
                <!-- //è¡¨å•ç»“æŸ -->
            </div>
        </div>
    </div>

    <!-- jséƒ¨åˆ† -->
    <script type="text/javascript" src="__LIBS__/layui/layui.js"></script>
    <script type="text/javascript" src="__NJS__/common.js?v=317"></script>
    <script src="__JS__/plugins/ueditor/ueditor.config.js" ></script><!--ç™¾åº¦å¯Œæ–‡æœ¬-->
    <script src="__JS__/plugins/ueditor/ueditor.all.js" ></script><!--ç™¾åº¦å¯Œæ–‡æœ¬-->
    <script>
        //ç™¾åº¦å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
        var editor = UE.getEditor('LAY_editor2', {
            initialFrameWidth:750,
            initialFrameHeight:450,
            autoHeight: false,
            autoHeightEnabled:false,
            autoFloatEnabled:false
        });
        //è‡ªå®šä¹‰ä¸Šä¼ æ¥å£
        UE.Editor.prototype._bkGetActionUrl = UE.Editor.prototype.getActionUrl;
        UE.Editor.prototype.getActionUrl = function(action) {
            if (action == 'uploadimage' || action == 'uploadscrawl') {
                return '/index.php/admin/upload/ueditorUpload';//è¿™å°±æ˜¯è‡ªå®šä¹‰çš„ä¸Šä¼ åœ°å€
            } else {
                return this._bkGetActionUrl.call(this, action);
            }
        }
        layui.use(['layer', 'form', 'laydate','upload','admin'], function () {
            var $ = layui.jquery;
            var layer = layui.layer;
            var form = layui.form;
            var laydate = layui.laydate;
            var upload = layui.upload;
            var admin = layui.admin;
            //æ™®é€šå›¾ç‰‡ä¸Šä¼ 
            var uploadInst = upload.render({
                elem: '#test1'
                ,url: "{:url('admin/Upload/uploadLocal')}" //æ”¹æˆæ‚¨è‡ªå·±çš„ä¸Šä¼ æ¥å£
                ,before: function(obj){
                    //é¢„è¯»æœ¬åœ°æ–‡ä»¶ç¤ºä¾‹ï¼Œä¸æ”¯æŒie8
                    obj.preview(function(index, file, result){
                        $('#demo1').attr('src', result); //å›¾ç‰‡é“¾æ¥ï¼ˆbase64ï¼‰
                    });
                }
                ,done: function(res){
                    console.log(res)
                    //å¦‚æœä¸Šä¼ å¤±è´¥
                    if(res.code == 0){
                        $("input[name='img']").val(res.data);
                    }
                    //ä¸Šä¼ æˆåŠŸ
                }
                ,error: function(){
                    //æ¼”ç¤ºå¤±è´¥çŠ¶æ€ï¼Œå¹¶å®ç°é‡ä¼ 
                    var demoText = $('#demoText');
                    demoText.html('<span style="color: #FF5722;">ä¸Šä¼ å¤±è´¥</span> <a class="layui-btn layui-btn-xs demo-reload">é‡è¯•</a>');
                    demoText.find('.demo-reload').on('click', function(){
                        uploadInst.upload();
                    });
                }
            });
            /* æ¸²æŸ“laydate */
            laydate.render({
                elem: '#formBasDateSel',
                trigger: 'click',
                range: true
            });
            /* ç›‘å¬è¡¨å•æäº¤ */
            form.on('submit(formBasSubmit)', function (data) {
                $('.layui-btn').addClass('layui-disabled').attr('disabled','disabled');
                $.ajax({
                    url:"{:url('add_teacher')}",
                    type:'post',
                    dataType:'json',
                    data:data.field,
                    success:function(res){
                        //console.log(res)
                        if (res.code == 0) {
                            layer.msg(res.msg,{icon:1,time:1500,shade:0.1})
                            setTimeout(function () {
                                admin.closeThisTabs();
                            }, 1000);
                        } else {
                            $(".layui-btn").removeClass('layui-disabled').removeAttr('disabled');
                            wk.error(res.msg);
                            return false;
                        }
                    }
                })
            });



            // è·å–å†…å®¹
            $('#btnDemoEdtGetContent').click(function () {
                var content = tinymce.get('demoEditor').getContent();
                layer.alert(content, { skin: 'layui-layer-admin', shade: .1 });
            });

            // è·å–æ–‡æœ¬
            $('#btnDemoEdtGetText').click(function () {
                var content = tinymce.get('demoEditor').getContent({ format: 'text' });
                layer.alert(content, { skin: 'layui-layer-admin', shade: .1 });
            });

            // ä¿®æ”¹æ–‡æœ¬
            $('#btnDemoEdtSetContent').click(function () {
                var content = [
                    '<div style="text-align: center;color: #fff;background-image: linear-gradient(to right,#009688,#5fb878);padding: 20px;">',
                    '   <div style="font-size: 28px;margin-bottom: 10px;">EASY WEB åå°ç®¡ç†æ¨¡æ¿</div>',
                    '   <div style="font-size: 18px">åŸºäºLayuiçš„ä¸€å¥—é€šç”¨å‹åå°ç®¡ç†æ¨¡æ¿ï¼Œæ‹¥æœ‰ä¼—å¤šåŸåˆ›ç»„ä»¶åŠæ¨¡æ¿é¡µé¢</div>',
                    '</div><br/>'
                ].join('');
                tinymce.get('demoEditor').setContent(content);
            });

            // æ’å…¥æ–‡æœ¬
            $('#btnDemoEdtInsertContent').click(function () {
                tinymce.get('demoEditor').insertContent('ğŸ‘èµ~', {});
            });

            // å¼¹çª—ä¸­ä½¿ç”¨
            $('#btnDemoEdtShowLayer').click(function () {
                admin.open({
                    title: 'å¯Œæ–‡æœ¬ç¼–è¾‘å™¨',
                    type: 1,
                    area: '820px',
                    offset: '45px',
                    content: '<textarea id="demoEditor2"></textarea>',
                    success: function () {
                        tinymce.init({
                            selector: '#demoEditor2',
                            height: 480,
                            branding: false,
                            language: 'zh_CN',
                            plugins: 'code print preview fullscreen paste searchreplace save autosave link autolink image imagetools media table codesample lists advlist hr charmap emoticons anchor directionality pagebreak quickbars nonbreaking visualblocks visualchars wordcount',
                            toolbar: 'fullscreen preview code | undo redo | forecolor backcolor | bold italic underline strikethrough | alignleft aligncenter alignright alignjustify | outdent indent | numlist bullist | formatselect fontselect fontsizeselect | link image media emoticons charmap anchor pagebreak codesample | ltr rtl',
                            toolbar_drawer: 'sliding',
                            images_upload_url: '../../../json/tinymce-upload-ok.json',
                            file_picker_types: 'media',
                            file_picker_callback: function (callback, value, meta) {
                                layer.msg('æ¼”ç¤ºç¯å¢ƒä¸å…è®¸ä¸Šä¼ ', { anim: 6 });
                            }
                        });
                    },
                    end: function () {
                        tinymce.get('demoEditor2').destroy(false);
                    }
                });
            });

        });
    </script>
</body>

</html>